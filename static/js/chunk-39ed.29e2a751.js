(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-39ed"],{"14gn":function(e,t,a){var s=a("qRLD");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,a("SZ7m").default)("0dbe71e9",s,!0,{})},"2ov0":function(e,t,a){var s=a("HTEg");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,a("SZ7m").default)("478336cc",s,!0,{})},"5SXT":function(e,t,a){"use strict";a.r(t);var s=a("YEIV"),n=a.n(s),l=a("QbLZ"),i=a.n(l),r=a("FRYs"),o=a.n(r),u=a("jr1U"),d=a.n(u),c=a("rfXi"),p=a.n(c),h=a("Kw5r");function _(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=[];return p()(e).forEach(function(e){void 0===e._expanded&&h.default.set(e,"_expanded",t);var l=1;if(void 0!==s&&null!==s&&(l=s+1),h.default.set(e,"_level",l),a&&h.default.set(e,"parent",a),n.push(e),e.children&&e.children.length>0){var i=_(e.children,t,e,l);n=n.concat(i)}}),n}var f={name:"TreeTable",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1}},computed:{formatData:function(){var e=void 0;e=Array.isArray(this.data)?this.data:[this.data];var t=this.evalFunc||_,a=this.evalArgs?d()([e,this.expandAll],this.evalArgs):[e,this.expandAll];return t.apply(null,a)}},methods:{showRow:function(e){var t=!e.row.parent||e.row.parent._expanded&&e.row.parent._show;return e.row._show=t,t?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},toggleExpanded:function(e){var t=this.formatData[e];t._expanded=!t._expanded},iconShow:function(e,t){return 0===e&&t.children&&t.children.length>0},addPageDialog:function(e){this.$emit("openPageDialog",e)},delDialog:function(e,t){var a={pageId:e,tag:t};this.$emit("opendelMeunDialog",a)}}},b=(a("6bP5"),a("Sc+u"),a("KHd+")),m=Object(b.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-table",e._b({attrs:{data:e.formatData,"row-style":e.showRow}},"el-table",e.$attrs,!1),[0===e.columns.length?a("el-table-column",{attrs:{width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row._level,function(e){return a("span",{key:e,staticClass:"ms-tree-space"})}),e._v(" "),e.iconShow(0,t.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(a){e.toggleExpanded(t.$index)}}},[t.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n      "+e._s(t.$index)+"\n    ")]}}])}):e._l(e.columns,function(t,s){return a("el-table-column",{key:t.data,attrs:{label:t.text,width:t.width},scopedSlots:e._u([{key:"default",fn:function(n){return[e._l(n.row._level,function(t){return 0===s?a("span",{key:t,staticClass:"ms-tree-space"}):e._e()}),e._v(" "),e.iconShow(s,n.row)?a("span",{staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(n.$index)}}},[n.row._expanded?a("i",{staticClass:"el-icon-minus"}):a("i",{staticClass:"el-icon-plus"})]):e._e(),e._v("\n     "+e._s(n.row[t.value])+"\n    ")]}}])})}),e._v(" "),e._t("default")],2)},[],!1,null,"835751dc",null);m.options.__file="index.vue";var g=m.exports,v=a("7Qib"),y=a("N4Yp"),A=a("X4fA"),x=a("L2JU"),k=(a("Yfch"),a("6Uqi")),w={name:"auth",components:{draggable:o.a,treeTable:g,PageTable:k.a},data:function(){return{pageName:"权限",table_list:[{type:"stateMuch",label:"权限类型",width:"100px",name:"userType",stateMuch:{1:"系统权限",2:"产品权限",3:"代理商权限"},checked:!0},{label:"角色名称",width:"100px",name:"name",checked:!0},{type:"stateMuch",label:"状态",width:"100px",name:"status",stateMuch:{0:"禁用",1:"启用",2:"删除"},checked:!0},{type:"popover",label:"描述",name:"desc",checked:!0},{type:"date",label:"创建时间",name:"insertDate",checked:!0}],addMenuVisible:!1,listLoading:!1,selectData:[],authGroupList:[],menuList:[],rules:[],color:"#409EFF",searchData:{userType:Object(A.f)()-0,name:"",status:1,lastId:""},searchData2:{},leftMenuList:[],defaultProps:{children:"menuData",label:"name"},editOrSave:!1,addAuth:{productId:"",userType:-1,getPtId:"",partName:"",partStatus:!0,copyAuth:!1,beCopiedGroupId:"",selectType:1,partDesc:""},rules2:{partName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}]},role_lable:"角色信息",editRoleId:"",ok_sure_btn:!1,add_or_edit:!1,currentButton:[],user_type:Object(A.f)()-0,addAuthList:[]}},computed:i()({},Object(x.b)(["auth_role_list","get_auth_menu","auth_role_one","productInfo","ptList"])),watch:n()({addMenuVisible:function(e){this.role_lable="角色信息",this.add_or_edit||e&&this.$store.dispatch("GetSysMenu")},productInfo:function(e,t){e.id!=t.id&&t.id&&this.sizeChange(10)}},"addAuth.userType",function(e,t){this.addAuth.selectType=e,1==e&&(this.addAuth.productId=JSON.parse(Object(A.b)()).id)}),mounted:function(){var e=this;this.$nextTick(function(){Object(v.e)().then(function(t){e.currentButton=t,e.sizeChange(10)})})},methods:{getAddAuthList:function(){var e=this;this.addAuth.beCopiedGroupId="";var t={productId:this.addAuth.productId,userType:this.addAuth.selectType,lastId:"",name:"",status:1,pageSize:0};Object(y.i)(t).then(function(t){e.addAuthList=t.rows})},currentChange:function(e){this.select_query(e)},sizeChange:function(e){this.searchData2=this.copy_obj(this.searchData),this.select_query(1,e)},select_query:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.searchData2.pageNum=e||this.auth_role_list.pageNum,this.searchData2.pageSize=t||this.auth_role_list.pageSize,this.$store.dispatch("GetAuthGroup",this.searchData2)},getMenuAuthGroupList:function(){var e=this;this.listLoading=!0,Object(y.n)().then(function(t){e.authGroupList=t.rows,e.listLoading=!1})},openAddDialog:function(){this.ok_sure_btn=!1,this.leftMenuList=[],this.addMenuVisible=!0},editRole:function(){var e=this;return 0==this.selectData.length||this.selectData.length>1?this.$message.warning("请选择一个角色"):(this.editRoleId=this.selectData[0].id,2==this.selectData[0].status?this.$message.error("删除的角色权限不可编辑"):(this.ok_sure_btn=!1,this.addMenuVisible=!0,void this.$store.dispatch("GetAuthGroupOne",{id:this.editRoleId}).then(function(t){e.addAuth.userType=e.auth_role_one.list.userType,e.addAuth.partName=e.auth_role_one.list.name,e.addAuth.partDesc=e.auth_role_one.list.desc,e.leftMenuList=[],e.auth_role_one.list.subGetAuthGroupOneSysMenuList.find(function(t){!function e(t,a){t.checked&&(a.push(t.id),t.menuData.length&&t.menuData.find(function(t){e(t,a)}))}(t,e.leftMenuList)})})))},okSureBtn:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return t.role_lable="角色信息",t.$message.error("请填写完整信息"),!1;var a=[];if(!t.addAuth.copyAuth||t.add_or_edit){var s=function e(t,a,s){s.find(function(n){if(t.id==n){var l={id:t.id,subAddAuthGroupList:[]};a.push(l),t.menuData.find(function(t){e(t,a[a.length-1].subAddAuthGroupList,s)})}})},n=t.$refs.tree.getHalfCheckedKeys().concat(t.$refs.tree.getCheckedKeys());if(t.add_or_edit?t.auth_role_one.list.subGetAuthGroupOneSysMenuList.find(function(e){s(e,a,n)}):t.get_auth_menu.list.find(function(e){s(e,a,n)}),!a.length)return t.role_lable="角色权限",void t.$message.error("请选择角色权限")}t.ok_sure_btn=!0,t.$store.dispatch(t.add_or_edit?"EditAuthGroup":"AddAuthGroup",{id:t.editRoleId,desc:t.addAuth.partDesc,userType:t.addAuth.userType,name:t.addAuth.partName,beCopiedGroupId:t.addAuth.copyAuth||!t.add_or_edit?t.addAuth.beCopiedGroupId:"",subAddAuthGroupList:a}).then(function(e){t.addMenuVisible=!1,t.ok_sure_btn=!1,t.$message.success(t.add_or_edit?"修改成功":"添加成功"),t.select_query()}).catch(function(e){t.ok_sure_btn=!1})})},statusEvent:function(e){var t=this;this.$store.dispatch("reqUrl_Status",{selectData:this.selectData,statusName:e.statusName,status:e.status,reqName:e.reqName,statusList:[{name:"启用",status:1},{name:"禁用",status:0},{name:"删除",status:3}]}).then(function(e){t.$store.dispatch("GetAuthGroup",t.searchData2).then(function(e){t.$message.success(e.msg),t.select_query(t.showPageNum(t.auth_role_list.pageNum,t.auth_role_list.pageSize,e.total))})})},handleSelectionChange:function(e){this.selectData=e},resetForm:function(e){this.$refs[e].resetFields(),this.leftMenuList=null},btnClickHandle:function(e){switch(e){case"add":this.addAuth.userType=Object(A.f)()-0,this.add_or_edit=!1,this.openAddDialog();break;case"edit":this.add_or_edit=!0,this.editRole();break;case"off":this.statusEvent({statusName:"确定禁用吗？",status:0,reqName:y.f});break;case"on":this.statusEvent({statusName:"确定启用吗？",status:1,reqName:y.f});break;case"del":this.statusEvent({statusName:"确定删除吗？",status:3,reqName:y.c})}}}},C=(a("wkRM"),Object(b.a)(w,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("nav",[a("el-row",{staticClass:"margin-b-20"},[3!=e.user_type?a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title"},[e._v(e._s(e.pageName)+"类型")]),e._v(" "),a("el-select",{staticClass:"wh-select",attrs:{placeholder:"请选择",filterable:""},model:{value:e.searchData.userType,callback:function(t){e.$set(e.searchData,"userType",t)},expression:"searchData.userType"}},[a("el-option",{key:"-1",attrs:{label:"全部",value:-1}}),e._v(" "),1==e.user_type?a("el-option",{key:"1",attrs:{label:"系统"+e.pageName,value:1}}):e._e(),e._v(" "),1==e.user_type||2==e.user_type?a("el-option",{key:"2",attrs:{label:"产品"+e.pageName,value:2}}):e._e(),e._v(" "),a("el-option",{key:"3",attrs:{label:"代理商"+e.pageName,value:3}})],1)],1):e._e(),e._v(" "),a("el-input",{staticClass:"nav-input font-w-5",attrs:{placeholder:"请输入角色名称",clearable:!0},model:{value:e.searchData.name,callback:function(t){e.$set(e.searchData,"name","string"==typeof t?t.trim():t)},expression:"searchData.name"}},[a("template",{slot:"prepend"},[e._v("角色名称")])],2),e._v(" "),a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title"},[e._v("状态")]),e._v(" "),a("el-select",{staticClass:"wh-select select-w-3",attrs:{placeholder:"全部"},model:{value:e.searchData.status,callback:function(t){e.$set(e.searchData,"status",t)},expression:"searchData.status"}},[a("el-option",{key:"-1",attrs:{label:"全部",value:-1}}),e._v(" "),a("el-option",{key:"1",attrs:{label:"启用",value:1}}),e._v(" "),a("el-option",{key:"0",attrs:{label:"禁用",value:0}}),e._v(" "),a("el-option",{key:"2",attrs:{label:"删除",value:2}})],1)],1),e._v(" "),a("el-button",{staticClass:"search margin-t-20",attrs:{type:"primary"},on:{click:function(t){e.sizeChange(10)}}},[e._v("查询")])],1)],1),e._v(" "),a("PageTable",{attrs:{noSelect:!0,tableList:e.table_list,tableData:e.auth_role_list,currentButton:e.currentButton},on:{handleSelectionChange:e.handleSelectionChange,sizeChange:e.sizeChange,currentChange:e.currentChange,btnClickHandle:e.btnClickHandle}}),e._v(" "),a("el-dialog",{staticClass:"authDialog",attrs:{"close-on-click-modal":!1,"append-to-body":!0,width:"470px",title:e.add_or_edit?"编辑角色权限":"添加角色权限",visible:e.addMenuVisible},on:{"update:visible":function(t){e.addMenuVisible=t},close:function(t){e.resetForm("addAuth")}}},[a("div",{staticClass:"del-dialog-cnt"},[a("el-form",{ref:"addAuth",attrs:{model:e.addAuth,rules:e.rules2,"label-width":"120px"}},[a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.get_auth_menu.loading||e.auth_role_one.loading,expression:"get_auth_menu.loading||auth_role_one.loading"}],attrs:{"element-loading-text":"Loading",type:"border-card"},model:{value:e.role_lable,callback:function(t){e.role_lable=t},expression:"role_lable"}},[a("el-tab-pane",{staticClass:"fl role_info",attrs:{label:"角色信息",name:"角色信息"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-menu"}),e._v(" 角色信息\n            ")]),e._v(" "),a("el-form-item",{attrs:{label:e.pageName+"类型",prop:"userType"}},[a("el-select",{staticClass:"select-w-2",attrs:{disabled:e.add_or_edit,placeholder:"请选择"},model:{value:e.addAuth.userType,callback:function(t){e.$set(e.addAuth,"userType",t)},expression:"addAuth.userType"}},[1==e.user_type?a("el-option",{key:"1",attrs:{label:"系统"+e.pageName,value:1}}):e._e(),e._v(" "),1==e.user_type||2==e.user_type?a("el-option",{key:"2",attrs:{label:"产品"+e.pageName,value:2}}):e._e(),e._v(" "),a("el-option",{key:"3",attrs:{label:"代理商"+e.pageName,value:3}})],1)],1),e._v(" "),e.add_or_edit?e._e():a("el-form-item",{attrs:{label:"是否复制",prop:"copyAuth",rules:[{required:!0,message:"请选择是否复制",trigger:"change"}]}},[a("el-radio",{attrs:{label:!0},model:{value:e.addAuth.copyAuth,callback:function(t){e.$set(e.addAuth,"copyAuth",t)},expression:"addAuth.copyAuth"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:!1},model:{value:e.addAuth.copyAuth,callback:function(t){e.$set(e.addAuth,"copyAuth",t)},expression:"addAuth.copyAuth"}},[e._v("否")])],1),e._v(" "),1==e.user_type&&e.addAuth.copyAuth&&1!=e.addAuth.userType?a("el-form-item",{attrs:{label:"复制产品",prop:"productId",rules:[{required:!0,message:"复制产品不能为空",trigger:"change"}]}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.addAuth.productId,callback:function(t){e.$set(e.addAuth,"productId",t)},expression:"addAuth.productId"}},e._l(e.ptList.list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),e.addAuth.copyAuth&&1!=e.addAuth.userType?a("el-form-item",{attrs:{label:"复制"+e.pageName+"类型",prop:"selectType",rules:[{required:!0,message:"请选择是否复制",trigger:"change"}]}},[a("el-select",{staticClass:"select-w-2",attrs:{placeholder:"请选择"},model:{value:e.addAuth.selectType,callback:function(t){e.$set(e.addAuth,"selectType",t)},expression:"addAuth.selectType"}},[1==e.user_type&&1==e.addAuth.userType?a("el-option",{key:"1",attrs:{label:"系统"+e.pageName,value:1}}):e._e(),e._v(" "),1==e.user_type||2==e.user_type?a("el-option",{key:"2",attrs:{label:"产品"+e.pageName,value:2}}):e._e(),e._v(" "),a("el-option",{key:"3",attrs:{label:"代理商"+e.pageName,value:3}})],1)],1):e._e(),e._v(" "),e.addAuth.copyAuth?a("el-form-item",{attrs:{label:"选择权限",prop:"beCopiedGroupId",rules:[{required:!0,message:"角色权限不能为空",trigger:"change"}]}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{focus:e.getAddAuthList},model:{value:e.addAuth.beCopiedGroupId,callback:function(t){e.$set(e.addAuth,"beCopiedGroupId",t)},expression:"addAuth.beCopiedGroupId"}},e._l(e.addAuthList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"角色名称",prop:"partName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.addAuth.partName,callback:function(t){e.$set(e.addAuth,"partName","string"==typeof t?t.trim():t)},expression:"addAuth.partName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色描述",prop:"partDesc"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入角色描述"},model:{value:e.addAuth.partDesc,callback:function(t){e.$set(e.addAuth,"partDesc","string"==typeof t?t.trim():t)},expression:"addAuth.partDesc"}})],1)],1),e._v(" "),e.addAuth.copyAuth?e._e():a("el-tab-pane",{attrs:{label:"角色权限",name:"角色权限"}},[a("el-tree",{ref:"tree",attrs:{data:e.add_or_edit?e.auth_role_one.list.subGetAuthGroupOneSysMenuList:e.get_auth_menu.list,"show-checkbox":"","default-expand-all":!1,"check-strictly":!0,"node-key":"id","default-checked-keys":e.leftMenuList,"highlight-current":"",props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var s=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",{staticClass:"el-tree-node__label"},[e._v(e._s(s.name)+"("+e._s(1==s.menuType?"菜单":2==s.menuType?"页面":"按钮")+")")])])}}])})],1)],1)],1)],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addMenuVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",loading:e.ok_sure_btn},on:{click:function(t){e.okSureBtn("addAuth")}}},[e._v("确 定")])],1)])],1)},[],!1,null,null,null));C.options.__file="auth.vue";t.default=C.exports},"6O2G":function(e,t,a){var s=a("DbKN");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);(0,a("SZ7m").default)("411c4f36",s,!0,{})},"6bP5":function(e,t,a){"use strict";var s=a("6O2G");a.n(s).a},DbKN:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"\n@keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n@-webkit-keyframes treeTableShow {\nfrom {opacity: 0;\n}\nto {opacity: 1;\n}\n}\n",""])},HTEg:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"\n.auth {\n  border: 1px solid #ddd;\n  /* height: 500px; */\n  /* overflow-y: scroll; */\n}\n.auth-title {\n  border-bottom: 1px solid #ddd;\n  line-height: 40px;\n  height: 40px;\n  font-weight: 600;\n  font-size: 15px;\n  padding-left: 20px;\n}\n.btn-add-group {\n  margin: 5px 20px 0 20px;\n}\n.auth ul {\n  padding: 0 10px;\n}\n.auth .el-input__inner {\n  border: none;\n}\n.auth ul li {\n  color: #646464;\n  list-style: none;\n  cursor: pointer;\n  height: 40px;\n  background-color: #fff;\n  text-align: left;\n  line-height: 34px;\n  padding: 5px 10px;\n  border-left: 1px solid #eee;\n  border-right: 1px solid #eee;\n  /* -webkit-box-sizing: border-box; */\n  /* box-sizing: border-box; */\n  /* -webkit-box-shadow: 0px 1px 3px 0 rgba(0, 0, 0, 0.2); */\n  /* box-shadow: 0px 1px 3px 0 rgba(0, 0, 0, 0.2); */\n}\n.btn-right {\n  float: right;\n}\n.auth ul li:nth-child(even) {\n  background: #fafafa;\n  border-top: 1px solid #eee;\n}\n.auth ul li:nth-child(odd) {\n  border-top: 1px solid #eee;\n}\n.auth ul li:last-child {\n  border-bottom: 1px solid #eee;\n}\n.auth .el-collapse-item__header {\n  padding-left: 20px;\n}\n",""])},"Sc+u":function(e,t,a){"use strict";var s=a("14gn");a.n(s).a},qRLD:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,'\n.ms-tree-space[data-v-835751dc] {\n  position: relative;\n  top: 1px;\n  display: inline-block;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1;\n  width: 18px;\n  height: 14px;\n}\n.ms-tree-space[data-v-835751dc]::before {\n    content: "";\n}\n.processContainer[data-v-835751dc] {\n  width: 100%;\n  height: 100%;\n}\ntable td[data-v-835751dc] {\n  line-height: 26px;\n}\n.tree-ctrl[data-v-835751dc] {\n  position: relative;\n  cursor: pointer;\n  color: #2196F3;\n  margin-left: -18px;\n}\n',""])},wkRM:function(e,t,a){"use strict";var s=a("2ov0");a.n(s).a}}]);