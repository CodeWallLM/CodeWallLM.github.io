(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-46c5"],{"1q5V":function(e,t,a){"use strict";var i=a("5L4L");a.n(i).a},"5L4L":function(e,t,a){var i=a("D1CJ");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("SZ7m").default)("184ef00a",i,!0,{})},D1CJ:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,"\n.no-m-b[data-v-133c700e] {\r\n  margin-bottom: 0;\n}\n.custom-err[data-v-133c700e] {\r\n  font-size: 12px;\r\n  height: 16px;\r\n  line-height: 16px;\n}\n.edit-agent-list[data-v-133c700e] {\r\n  width: 300px;\r\n  max-height: 200px;\r\n  overflow-x: auto;\r\n  overflow-y: auto;\r\n  border: 1px solid #e9e9e9;\n}\n.edit-date-width[data-v-133c700e] {\r\n  width: 142px !important;\n}\r\n",""])},DS4p:function(e,t,a){"use strict";a.r(t);var i=a("FyfS"),s=a.n(i),n=a("14Xm"),l=a.n(n),r=a("D3Ub"),o=a.n(r),d=a("QbLZ"),c=a.n(d),u=a("L2JU"),h=a("rY9o"),p=a("X4fA"),g=a("t3Un");function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(g.a)({url:"/api/DownloadTask/getTaskList",method:"post",data:e})}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(g.a)({url:"/api/DownloadTask/getUserIdAndName",method:"post",data:e})}var v=a("7Qib"),b=a("6Uqi"),y=a("4Vms"),k={name:"customTask",components:{PageTable:b.a,agentBox:y.a},data:function(){var e=this;return{pickerBeginDateBefore:{disabledDate:function(t){return!!e.listQuery.endTime&&t.getTime()>new Date(e.listQuery.endTime).getTime()}},pickerBeginDateAfter:{disabledDate:function(t){return!!e.listQuery.startTime&&t.getTime()<new Date(e.listQuery.startTime).getTime()}},listQuery:{endTime:"",pageNum:1,pageSize:10,productAgentId:"",productId:"",startTime:"",status:0,taskType:0,userLoginId:""},userQuery:{productAgentId:"",productId:""},tableList:[{label:"代理商",name:"productAgentName",width:"160px",checked:!0},{label:"任务类型",name:"taskType",width:"100px",type:"stateMuch",stateMuch:{1:"收款明细",2:"结算明细"},checked:!0},{label:"起止时间",name:"startAndEndTime",width:"160px",checked:!0},{label:"任务状态",name:"status",width:"100px",type:"stateMuch",stateMuch:{1:"未完成",2:"完成",3:"删除"},checked:!0},{label:"地址",name:"fileURL",width:"150px",type:"hyperlink",checked:!0},{label:"添加人",name:"userLoginName",width:"100px",checked:!0},{label:"添加时间",name:"insertDate",width:"170px",checked:!0}],tableData:{list:[],loading:!1,pageNum:1,pageSize:10,total:0},btnLoading:!1,editFormVisible:!1,editCheckedAll:!1,userList:[],selectedData:[],currentButton:[],productAgentidArr:[],editTreeProps:{children:"children",label:"label"},editForm:{endTime:"",startTime:"",taskType:1}}},computed:c()({},Object(u.b)(["agentList","productInfo"])),watch:{productInfo:function(e,t){e.id!=t.id&&t.id&&this.mountedInit()}},mounted:function(){this.mountedInit()},methods:{selectAgentFun:function(e){this.listQuery.productAgentId=e,this.userQuery.productAgentId=e,this.getUserListData()},mountedInit:function(){this.setProductId(),this.setDefaultDate(),this.getPageData()},setProductId:function(){var e=JSON.parse(Object(p.b)());this.listQuery.productId=e.id,this.userQuery.productId=e.id},setDefaultDate:function(){var e=new Date,t=new Date,a=e.getFullYear()-3,i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),n=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");this.listQuery.startTime=a+"-"+i+"-"+s,this.listQuery.endTime=n+"-"+l+"-"+r},getPageData:function(){var e=this;return o()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=null,e.tableData.loading=!0,t.next=4,Object(v.e)();case 4:return a=t.sent,e.currentButton=a,t.next=8,f(e.userQuery);case 8:return a=t.sent,e.userList=a.rows,t.next=12,m(e.listQuery);case 12:a=t.sent,e.tableData.list=a.rows,e.tableData.total=a.total,e.tableData.loading=!1;case 16:case"end":return t.stop()}},t,e)}))()},getUserListData:function(){var e=this;f(this.userQuery).then(function(t){e.userList=t.rows})},getTaskListData:function(){var e=this;this.tableData.loading=!0,m(this.listQuery).then(function(t){e.tableData.list=t.rows,e.tableData.total=t.total,e.tableData.loading=!1}).catch(function(){return e.tableData.loading=!1})},searchData:function(){this.listQuery.pageNum=1,this.listQuery.pageSize=10,this.tableData.pageNum=1,this.tableData.pageSize=10,this.getTaskListData()},handleSelectionChange:function(e){this.selectedData=e},handleSizeChange:function(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.tableData.pageNum=1,this.tableData.pageSize=e,this.getTaskListData()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.tableData.pageNum=e,this.getTaskListData()},closeDialog:function(){this.resetForm("editForm")},editFormSubmit:function(){var e=this,t=this.editForm.endTime,a=this.editForm.startTime,i=this.$refs.editTree.getCheckedKeys();if(i&&0!==i.length)if(a)if(t){this.btnLoading=!0;var s={list:[]};a+=a.indexOf("00:00:00")>-1?"":" 00:00:00",t+=t.indexOf("23:59:59")>-1?"":" 23:59:59";for(var n=0;n<i.length;n++){var l={endTime:t,productAgentId:i[n],productId:this.productInfo.id,startTime:a,taskType:this.editForm.taskType};s.list.push(l)}(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(g.a)({url:"/api/DownloadTask/insertList",method:"post",data:e})})(s).then(function(t){e.btnLoading=!1,e.$message.success(t.msg),e.editFormVisible=!1,e.getTaskListData()}).catch(function(){return e.btnLoading=!1})}else this.$message.warning("请选择结束时间");else this.$message.warning("请选择开始时间");else this.$message.warning("至少选中一条代理商")},resetForm:function(e){var t=this;setTimeout(function(){return t.$refs[e].resetFields()},300)},editCheckAllChange:function(){if(this.editCheckedAll){var e=[];this.getAgentListValueArr(this.agentList.list,e),this.$refs.editTree.setCheckedKeys(e)}else this.$refs.editTree.setCheckedKeys([])},getAgentListValueArr:function(e,t){var a=!0,i=!1,n=void 0;try{for(var l,r=s()(e);!(a=(l=r.next()).done);a=!0){var o=l.value;o.children&&o.children.length>0?(t.push(o.value),this.getAgentListValueArr(o.children,t)):t.push(o.value)}}catch(e){i=!0,n=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw n}}},isNull:function(e){return 0!==e.length||(this.$message.warning("没有选中任何数据"),!1)},addEventHandle:function(){this.editFormVisible=!0},delEventHandle:function(){var e=this;this.isNull(this.selectedData)&&this.$confirm("删除不可恢复，是否确定删除？").then(function(){var t=[];e.selectedData.forEach(function(e){return t.push(e.id)}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(g.a)({url:"/api/DownloadTask/deleteByIds",method:"post",data:e})}({ids:t}).then(function(t){e.$message.success("删除操作成功"),e.getTaskListData()})})},getAgentList:function(){var e=this;this.$store.dispatch("reqUrl_SysData",{reqName:h.Ac,dataName:"agentList",data:{productID:JSON.parse(Object(p.b)()).id,showType:0,productAgentId:this.productAgentId}}).then(function(t){!function e(t){t.find(function(t){t.children&&t.children.length?e(t.children):delete t.children})}(e.agentList.list)})},btnClickHandle:function(e){switch(e){case"add":this.addEventHandle(),this.getAgentList();break;case"del":this.delEventHandle()}}}},D=(a("1q5V"),a("KHd+")),T=Object(D.a)(k,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("nav",[a("el-row",[a("agentBox",{attrs:{tag:1},on:{selectAgentFun:e.selectAgentFun}}),e._v(" "),a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title"},[e._v("操作人")]),e._v(" "),a("el-select",{staticClass:"handle-select select-w-3",attrs:{placeholder:"请选择",clearable:""},model:{value:e.listQuery.userLoginId,callback:function(t){e.$set(e.listQuery,"userLoginId",t)},expression:"listQuery.userLoginId"}},[a("el-option",{key:0,attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.userList,function(e){return a("el-option",{key:e.userLoginId,attrs:{label:e.userLoginName,value:e.userLoginId}})})],2)],1),e._v(" "),a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title"},[e._v("任务类型")]),e._v(" "),a("el-select",{staticClass:"handle-select select-w-5",attrs:{placeholder:"请选择",clearable:""},model:{value:e.listQuery.taskType,callback:function(t){e.$set(e.listQuery,"taskType",t)},expression:"listQuery.taskType"}},[a("el-option",{key:0,attrs:{label:"全部",value:0}}),e._v(" "),a("el-option",{key:1,attrs:{label:"收款明细",value:1}}),e._v(" "),a("el-option",{key:2,attrs:{label:"结算明细",value:2}})],1)],1),e._v(" "),a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title"},[e._v("任务状态")]),e._v(" "),a("el-select",{staticClass:"handle-select select-w-5",attrs:{placeholder:"请选择",clearable:""},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},[a("el-option",{key:0,attrs:{label:"全部",value:0}}),e._v(" "),a("el-option",{key:1,attrs:{label:"未完成",value:1}}),e._v(" "),a("el-option",{key:2,attrs:{label:"完成",value:2}}),e._v(" "),a("el-option",{key:3,attrs:{label:"删除",value:3}})],1)],1),e._v(" "),a("div",{staticClass:"nav-select"},[a("div",{staticClass:"nav-select-title mt1"},[e._v("添加时间")]),e._v(" "),a("el-date-picker",{attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"开始日期","picker-options":e.pickerBeginDateBefore},model:{value:e.listQuery.startTime,callback:function(t){e.$set(e.listQuery,"startTime",t)},expression:"listQuery.startTime"}}),e._v("-\n        "),a("el-date-picker",{attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"结束日期","picker-options":e.pickerBeginDateAfter},model:{value:e.listQuery.endTime,callback:function(t){e.$set(e.listQuery,"endTime",t)},expression:"listQuery.endTime"}})],1),e._v(" "),a("el-button",{staticClass:"search margin-t-20",attrs:{type:"primary"},on:{click:e.searchData}},[e._v("查询")])],1)],1),e._v(" "),a("PageTable",{attrs:{tableList:e.tableList,tableData:e.tableData,currentButton:e.currentButton},on:{handleSelectionChange:e.handleSelectionChange,sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange,btnClickHandle:e.btnClickHandle}}),e._v(" "),a("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,visible:e.editFormVisible,title:"添加任务",width:"520px"},on:{"update:visible":function(t){e.editFormVisible=t},close:e.closeDialog}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"代理商"}},[a("el-tree",{ref:"editTree",staticClass:"edit-agent-list",attrs:{data:e.agentList.list,props:e.editTreeProps,"node-key":"value","default-expand-all":"","show-checkbox":"","check-strictly":""}}),e._v(" "),a("el-checkbox",{on:{change:e.editCheckAllChange},model:{value:e.editCheckedAll,callback:function(t){e.editCheckedAll=t},expression:"editCheckedAll"}},[e._v("全选")])],1),e._v(" "),a("el-form-item",{attrs:{label:"任务类型"}},[a("el-select",{staticClass:"edit-date-width",attrs:{placeholder:"请选择",clearable:!0},model:{value:e.editForm.taskType,callback:function(t){e.$set(e.editForm,"taskType",t)},expression:"editForm.taskType"}},[a("el-option",{key:1,attrs:{label:"收款明细",value:1}}),e._v(" "),a("el-option",{key:2,attrs:{label:"结算明细",value:2}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"起止时间"}},[a("el-date-picker",{staticClass:"edit-date-width",attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"开始时间","picker-options":e.pickerBeginDateBefore},model:{value:e.editForm.startTime,callback:function(t){e.$set(e.editForm,"startTime",t)},expression:"editForm.startTime"}}),e._v(" -\n        "),a("el-date-picker",{staticClass:"edit-date-width",attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"结束时间","picker-options":e.pickerBeginDateAfter},model:{value:e.editForm.endTime,callback:function(t){e.$set(e.editForm,"endTime",t)},expression:"editForm.endTime"}})],1)],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.editFormVisible=!1}}},[e._v("关 闭")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.editFormSubmit}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"133c700e",null);T.options.__file="customTask.vue";t.default=T.exports},"RU/L":function(e,t,a){a("Rqdy");var i=a("WEpk").Object;e.exports=function(e,t,a){return i.defineProperty(e,t,a)}},Rqdy:function(e,t,a){var i=a("Y7ZC");i(i.S+i.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(e,t,a){e.exports={default:a("RU/L"),__esModule:!0}},YEIV:function(e,t,a){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(a("SEkw"));t.default=function(e,t,a){return t in e?(0,i.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}}}]);